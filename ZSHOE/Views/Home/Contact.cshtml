@model ContactPostInfoViewModel

@{
    ViewData["Title"] = "Contact";
}

<main class="main">
    <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Pages</a></li>
                <li class="breadcrumb-item active" aria-current="page">Contact us</li>
            </ol>
        </div><!-- End .container -->
    </nav><!-- End .breadcrumb-nav -->
    <div class="container">
        <div class="page-header page-header-big text-center" style="background-image: url('/uploads/images/@Model.ContactInfos?.ImagePath')">
            <h1 class="page-title text-white">Contact us<span class="text-white">keep in touch with us</span></h1>
        </div><!-- End .page-header -->
    </div><!-- End .container -->

    <div class="page-content pb-0">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 mb-2 mb-lg-0">
                    <h2 class="title mb-1">Contact Information</h2><!-- End .title mb-2 -->
                    <p class="mb-3">Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p>
                    <div class="row">
                        <div class="col-sm-7">
                            <div class="contact-info">
                                <h3>The Office</h3>

                                <ul class="contact-list">
                                    <li>
                                        <i class="icon-map-marker"></i>
                                       @Html.Raw(Model.ContactInfos?.Location)
                                    </li>
                                    <li>
                                        <i class="icon-phone"></i>
                                        <a href="tel:#"> @Model.ContactInfos?.PhoneNumber</a>
                                    </li>
                                    <li>
                                        <i class="icon-envelope"></i>
                                        <a href="mailto:#">@Model.ContactInfos?.CompanyEmail</a>
                                    </li>
                                </ul><!-- End .contact-list -->
                            </div><!-- End .contact-info -->
                        </div><!-- End .col-sm-7 -->
                    </div><!-- End .row -->
                </div><!-- End .col-lg-6 -->
                <div class="col-lg-6">
                    <h2 class="title mb-1">Got Any Questions?</h2><!-- End .title mb-2 -->
                    <p class="mb-2">Use the form below to get in touch with the sales team</p>

                    <form method="post" novalidate action="#" class="contact-form mb-3" id="contact_form_1">
                        <div class="row">
                            <div class="col-sm-6">
                                <label for="cname" class="sr-only">Name</label>
                                <input type="text" asp-for="@Model.ContactPosts.Name" class="form-control" id="cname" placeholder="Name *" required>
                                <span asp-validation-for="@Model.ContactPosts.Name" class="text-danger"></span>
                            </div><!-- End .col-sm-6 -->

                            <div class="col-sm-6">
                                <label for="cemail" class="sr-only">Email</label>
                                <input type="email" asp-for="@Model.ContactPosts.Email" class="form-control" id="cemail" placeholder="Email *" required>
                                <span asp-validation-for="@Model.ContactPosts.Email" class="text-danger"></span>
                            </div><!-- End .col-sm-6 -->
                        </div><!-- End .row -->

                        <div class="row">
                            <div class="col-sm-6">
                                <label for="cphone" class="sr-only">Phone</label>
                                <input type="tel" asp-for="@Model.ContactPosts.Phone" class="form-control" id="cphone" placeholder="Phone">
                                <span asp-validation-for="@Model.ContactPosts.Phone" class="text-danger"></span>
                            </div><!-- End .col-sm-6 -->

                            <div class="col-sm-6">
                                <label for="csubject" class="sr-only">Subject</label>
                                <input type="text" asp-for="@Model.ContactPosts.Subject" class="form-control" id="csubject" placeholder="Subject">
                                <span asp-validation-for="@Model.ContactPosts.Subject" class="text-danger"></span>
                            </div><!-- End .col-sm-6 -->
                        </div><!-- End .row -->

                        <label for="cmessage" class="sr-only">Message</label>
                        <textarea class="form-control" asp-for="@Model.ContactPosts.Content" cols="30" rows="4" id="cmessage" required placeholder="Message *"></textarea>
                        <span asp-validation-for="@Model.ContactPosts.Content" class="text-danger"></span>

                        <button type="submit" class="btn btn-outline-primary-2 btn-minwidth-sm">
                            <span>SUBMIT</span>
                            <i class="icon-long-arrow-right"></i>
                        </button>
                    </form><!-- End .contact-form -->
                </div><!-- End .col-lg-6 -->
            </div><!-- End .row -->
        </div><!-- End .container -->
    </div><!-- End .page-content -->
</main><!-- End .main -->

@section addcss{
    <link rel="stylesheet" href="~/libs/toastr.js/toastr.min.css" />
    <style>
        input[Name].novalidated,
        textarea[Name].novalidated {
            border: 1px solid rgb(223, 53,69);
        }
    </style>
}
    @section addjs{
    <script src="~/libs/toastr.js/toastr.min.js"></script>
    <script src="~/libs/toastr.js/toastr.customize.js"></script>

    <script>
        $(document).ready(function () {

            $("#contact_form_1").submit(function (ev) {
                ev.preventDefault();
                console.log(ev.currentTarget);

                let fd = new FormData(ev.currentTarget); // form => formData

                $.ajax({
                    url: '@Url.Action("Contact")',
                    type: "POST",
                    data: fd,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        $("#contact_form_1 span.text-danger").remove();
                        $("#contact_form_1 input[Name], #contact_form_1 textarea[Name]").removeClass("novalidated");
                        console.log(response, "SUCCESS");

                        if (response.error == true) {

                            toastr.error(response.message, "Xeta");
                            showError(response.state);

                            return;
                        }

                        toastr.success(response.message, "Ugur!");

                        ev.currentTarget.reset();
                    },
                    error: function (errResponse) {
                        console.log(errResponse, "ERROR");
                    }

                })
            })
        });

        function showError(state) {
            state.forEach(item => {

                let errorInput = $(`#contact_form_1 input[name = ${item.fieldName}], #contact_form_1 textarea[name = ${item.fieldName}]`);
                let errorSpan = $("<span/>", {
                    class: 'text-danger',
                    html: item.message
                });

                $(errorInput.parent()).append(errorSpan);
                $(errorInput).addClass("novalidated")
            });
        }
    </script>
}